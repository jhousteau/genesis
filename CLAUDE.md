# ‚ö†Ô∏è CONTEXT MODE: IMPROVING GENESIS (ALPHA) ‚ö†Ô∏è

**You are currently improving Genesis, not using it in a client project.**

Genesis is a development toolkit in active alpha development. This document prevents confusion between improving Genesis vs using Genesis in future projects.

## Context Detection Rules

### You're IMPROVING Genesis if:
- Working in the Genesis repository (directory named "genesis")
- Tasks involve enhancing Genesis components
- You're improving the genesis CLI tool
- Adding features to Genesis templates or core utilities

### You're USING Genesis if:
- The project has `.genesis/` configuration directory
- You're running `genesis` commands (not improving them)
- You're importing from Genesis libraries (not enhancing them)
- Working in a client project that uses Genesis

## Improving vs Using Genesis

| NOW (Improving Genesis)              | FUTURE (Using Genesis)                    |
|--------------------------------------|-------------------------------------------|
| Enhancing smart-commit.sh            | Running smart-commit.sh                   |
| Improving genesis CLI tool           | Running `genesis bootstrap <project>`     |
| Extending shared libraries           | Importing from shared libraries           |
| Enhancing Genesis components         | Using clean Genesis tools                 |
| Improving Genesis worktree tools     | Using Genesis to create project worktrees|
| Refining file count validation       | Benefiting from automatic file limits    |

## üéØ Core Building Principle: "Build Generic, Use Everywhere"

**CRITICAL RULE**: Nothing we build should be Genesis-specific unless absolutely necessary.

### The Rule
Any configuration, script, or template we create for Genesis must work for ANY project, not just Genesis. No hardcoding project names or Genesis-specific variables.

### Why This Matters
1. **Genesis uses its own patterns** (eating our own dog food)
2. **Templates are immediately reusable** without modification
3. **No refactoring needed** when extracting templates for other projects

### Examples of GOOD vs BAD

‚ùå **BAD** (Genesis-specific):
```bash
export GENESIS_MODE="development"
export LOG_LEVEL="info"
```

‚úÖ **GOOD** (Generic):
```bash
export PROJECT_MODE="development"
export LOG_LEVEL="info"
```

### Apply This Rule To Everything
- Environment variables ‚Üí Use PROJECT_* or generic names
- Makefile targets ‚Üí Generic names like `test`, `build`, not `test-genesis`
- Directory paths ‚Üí Use relative or PROJECT_ROOT, not PROJECT_ROOT
- Config files ‚Üí Should work for any project type
- CI/CD workflows ‚Üí Generic job names and steps

### The Litmus Test
Before creating any file, ask:
- "Would this work for a Python API project?"
- "Would this work for a CLI tool project?"
- "Would this work for a TypeScript library?"

If no, make it more generic.

## üö´ FORBIDDEN COMMIT SIGNATURES

**NEVER include any variation of these signatures in commits, PRs, or code:**

```
Generated with [Claude Code](https://claude.ai/code)
Generated with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>
Generated by Claude
Created with Claude Code
Claude AI assistance
AI-generated code
claude.ai/code
anthropic.com
noreply@anthropic.com
```

**Note**: Visual elements (emojis, icons) may change, but any reference to Claude, Anthropic, or AI assistance is forbidden.

**Reason**: Genesis is a professional development toolkit. All code should appear as human-authored work without AI attribution signatures.

## üö´ FORBIDDEN HARDCODED VALUES

**NEVER include hardcoded values or dangerous defaults in code:**

### Hardcoded Configuration Values
```python
# ‚ùå FORBIDDEN
DATABASE_URL = "postgresql://localhost:5432/app"
API_KEY = "sk-1234567890abcdef"
SERVICE_PORT = 8080

# ‚úÖ REQUIRED
DATABASE_URL = get_required_env("DATABASE_URL")
API_KEY = get_required_env("API_KEY")
SERVICE_PORT = int(get_required_env("SERVICE_PORT"))
```

### Dangerous Function Defaults
```python
# ‚ùå FORBIDDEN
def connect_db(host="localhost", port=5432, db="production"):
    pass

def send_request(url="https://api.hardcoded.com", timeout=30):
    pass

# ‚úÖ REQUIRED
def connect_db(host: str, port: int, db: str):
    """All parameters must be explicitly provided"""
    pass

def send_request(url: str, timeout: Optional[int] = None):
    """Use None/Optional for truly optional parameters"""
    pass
```

### Environment Variable Fallbacks
```python
# ‚ùå FORBIDDEN - Silent fallbacks hide configuration issues
database_url = os.environ.get("DATABASE_URL", "postgresql://localhost/app")
port = int(os.environ.get("PORT", "8080"))

# ‚úÖ REQUIRED - Fail fast with clear error messages
database_url = os.environ.get("DATABASE_URL")
if not database_url:
    raise ValueError("DATABASE_URL environment variable is required")
```

**Reason**: Hardcoded values create security risks, deployment issues, and make applications non-configurable. Genesis enforces fail-fast configuration loading and single source of truth patterns.

**Why Fail-Fast is Critical**: When required configuration is missing, the application should immediately fail with a clear error message. This approach:

1. **Catches configuration errors at startup** - not after hours of operation
2. **Provides clear, actionable error messages** - developers know exactly what to fix
3. **Prevents silent failures** - no mysterious behavior from missing config
4. **Enforces explicit configuration** - every deployment must be properly configured
5. **Eliminates security risks** - no accidental use of development defaults in production

Example of proper fail-fast behavior:
```
$ python -m genesis.cli smart-commit
ValueError: Log level not configured. Set LOG_LEVEL or configure environment.
```

This immediate, clear failure is infinitely better than the application running with unknown defaults.

**Detection**: Use `scripts/find-hardcoded-values.sh` and `scripts/check-variable-defaults.sh` to systematically find violations.

## üö´ FORBIDDEN FILE CLUTTER

**NEVER place files in wrong locations - maintain clean project organization:**

### Root Directory Rules
Only these file types are allowed in project root:
- **Configuration**: `README.md`, `CLAUDE.md`, `Makefile`, `pyproject.toml`, `package.json`, `.gitignore`, `.envrc`
- **Licensing**: `LICENSE`, `SECURITY.md`
- **Infrastructure**: `Dockerfile`, `docker-compose.yml`, `main.tf`, `variables.tf`

### Mandatory Directory Structure
```
project/
‚îú‚îÄ‚îÄ src/              # Source code ONLY
‚îú‚îÄ‚îÄ scripts/          # Executable utilities (.sh files)
‚îú‚îÄ‚îÄ tests/            # Test files (test_*.py, *.test.ts, conftest.py)
‚îú‚îÄ‚îÄ docs/             # Documentation (.md files except README/CLAUDE)
‚îî‚îÄ‚îÄ config/           # Configuration files (.json, .yml, .toml)
```

### File Placement Rules
```python
# ‚ùå FORBIDDEN - Clutters root directory
./my-script.sh           # ‚Üí Should be in scripts/
./api-docs.md           # ‚Üí Should be in docs/
./conftest.py          # ‚Üí Should be in tests/
./config.json          # ‚Üí Should be in config/
./util.py              # ‚Üí Should be in src/

# ‚úÖ REQUIRED - Proper organization
./scripts/my-script.sh
./docs/api-docs.md
./tests/conftest.py
./config/config.json
./src/util.py
```

**Reason**: File clutter makes projects hard to navigate, reduces professionalism, and violates standard project structure conventions.

**Detection**: Use `scripts/check-file-organization.sh` to systematically find misplaced files.

## ‚ö†Ô∏è Common Confusion Points

### Smart Commit
- **NOW**: We're refining smart-commit.sh for better reliability
- **FUTURE**: Projects will use the smart-commit tool we've created

### Directory Structure
- **NOW**: Improving genesis CLI and core utilities
- **FUTURE**: Projects import FROM these directories via Genesis

### Sparse Worktrees
- **NOW**: Enhancing Genesis worktree tools for better AI safety
- **FUTURE**: Projects use Genesis tools to create sparse worktrees

### Bootstrap Process
- **NOW**: Improving the bootstrap system and templates
- **FUTURE**: Running `genesis bootstrap` to create new projects

## Standard Project Structure

Genesis enforces a consistent folder structure across all projects:

```
project/
‚îú‚îÄ‚îÄ src/              # Source code
‚îú‚îÄ‚îÄ tests/            # Test files
‚îú‚îÄ‚îÄ docs/             # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ api/          # API documentation and references
‚îÇ   ‚îú‚îÄ‚îÄ guides/       # How-to guides and tutorials
‚îÇ   ‚îî‚îÄ‚îÄ architecture/ # System design and architecture decisions
‚îú‚îÄ‚îÄ scripts/          # Utility scripts (executable, self-documenting)
‚îú‚îÄ‚îÄ scratch/          # Temporary files (git-ignored)
‚îú‚îÄ‚îÄ .gitignore        # Includes scratch/ by default
‚îú‚îÄ‚îÄ Makefile          # Standard automation targets
‚îî‚îÄ‚îÄ README.md         # Project overview
```

### Folder Guidelines
- **scratch/**: Temporary workspace, always git-ignored
- **scripts/**: Executable utilities with `--help`, named `action-target.sh`
- **docs/**: Organized by type (api, guides, architecture)

## Current Genesis Components (Alpha State)

### Main Repository Structure
- **genesis/**: Core Python package with CLI and utilities
- **bootstrap/**: Project initialization system
- **smart-commit/**: Quality gates before commits
- **worktree-tools/**: AI-safe sparse worktree creation
- **templates/**: Project templates (Python API, CLI, TypeScript, Terraform)
- **shared-typescript/**: TypeScript utilities (separate worktree)
- **shared-python/**: Python utilities (separate worktree)
- **terraform/**: Infrastructure modules
- **docs/**: Comprehensive documentation
- **scripts/**: Utility scripts for validation and automation

### Worktree-Based Development
Genesis uses sparse worktrees for AI-safe development:
- **Main workspace**: 211 files (too large for AI)
- **Focused worktrees**: <30 files each for specific tasks
- **AI protection**: Built-in safeguards prevent context overflow

## AI Safety Rules (Apply to Both Modes)

### File Count Limits
- **Improving Genesis**: Each worktree <30 files for AI safety
- **Using Genesis**: Each worktree <30 files for AI safety

### Sparse Worktree Isolation
- **Improving Genesis**: Each component <30 files when checked out
- **Using Genesis**: Genesis enforces these limits automatically

### Quality Gates
- **Improving Genesis**: We maintain pre-commit hooks and testing
- **Using Genesis**: Genesis provides pre-configured quality gates

## What Genesis Provides (Alpha Release)

### CLI Commands (Currently Available)
```bash
genesis bootstrap <name>    # Create new project with templates
genesis autofix            # Run formatting and linting
genesis commit             # Smart commit with quality gates
genesis status             # Check project health
genesis sync               # Update shared components
genesis clean              # Clean workspace and worktrees
genesis version            # Version management utilities
```

### Core Libraries (Available Now)
- **Python**: `from genesis.core import retry, logger, config, health, errors`
- **Autofix**: Multi-stage convergent code fixing
- **Circuit Breaker**: Resilient failure handling
- **Context Management**: Structured error correlation

### Templates & Infrastructure (Ready to Use)
- 4 complete project templates (Python API, CLI, TypeScript, Terraform)
- Terraform modules for GCP infrastructure
- Pre-configured quality gates
- Security scanning (Bandit, Gitleaks)
- AI safety enforcement via worktrees

## Anti-Confusion Checklist

Before taking any action, verify:

- [ ] Am I improving Genesis or using Genesis?
- [ ] Am I in the Genesis repository? (Improving mode)
- [ ] Am I enhancing components or using them?
- [ ] Are file paths in `/genesis/` (improving) or `/project/` (using)?

## Success Metrics

### Improving Genesis Success:
- [ ] Genesis CLI stable and feature-complete
- [ ] Each component <30 files for AI safety
- [ ] All manual setup steps automated
- [ ] Genesis can bootstrap itself
- [ ] Quality gates prevent regressions

### Using Genesis Success:
- [ ] New project created in <2 minutes
- [ ] Automatic worktree isolation working
- [ ] Quality gates enforced by default
- [ ] Zero manual configuration needed

---

**Remember**: We are currently in **IMPROVING** mode. Genesis is in alpha - we're enhancing it.

This file helps AI assistants understand when they're working ON Genesis vs WITH Genesis.
