# ‚ö†Ô∏è CONTEXT MODE: BUILDING GENESIS ‚ö†Ô∏è

**You are currently BUILDING Genesis, not using it.**

Genesis is a development toolkit we are creating. This document prevents confusion between building Genesis vs using Genesis in future projects.

## Context Detection Rules

### You're BUILDING Genesis if:
- The project root contains `EXTRACTION_PLAN.md`  
- Tasks involve creating Genesis components
- You're creating the genesis-cli tool itself
- Working in a project directory named "genesis"

### You're USING Genesis if:
- The project has `.genesis/` configuration directory
- You're running `genesis` commands (not building them)
- You're importing from shared libraries (not creating them)
- There's no `EXTRACTION_PLAN.md`

## Building vs Using Genesis

| NOW (Building Genesis)               | FUTURE (Using Genesis)                    |
|--------------------------------------|-------------------------------------------|
| Creating smart-commit.sh             | Running smart-commit.sh                   |
| Building genesis CLI tool            | Running `genesis bootstrap <project>`     |
| Making shared libraries              | Importing from shared libraries           |
| Creating Genesis components          | Using clean Genesis tools                 |
| Setting up Genesis worktrees         | Using Genesis to create project worktrees|
| Implementing file count validation   | Benefiting from automatic file limits    |

## üéØ Core Building Principle: "Build Generic, Use Everywhere"

**CRITICAL RULE**: Nothing we build should be Genesis-specific unless absolutely necessary.

### The Rule
Any configuration, script, or template we create for Genesis must work for ANY project, not just Genesis. No hardcoding project names or Genesis-specific variables.

### Why This Matters
1. **Genesis uses its own patterns** (eating our own dog food)
2. **Templates are immediately reusable** without modification
3. **No refactoring needed** when extracting templates for other projects

### Examples of GOOD vs BAD

‚ùå **BAD** (Genesis-specific):
```bash
export GENESIS_MODE="development"
export GENESIS_LOG_LEVEL="info"
```

‚úÖ **GOOD** (Generic):
```bash
export PROJECT_MODE="development"
export LOG_LEVEL="info"
```

### Apply This Rule To Everything
- Environment variables ‚Üí Use PROJECT_* or generic names
- Makefile targets ‚Üí Generic names like `test`, `build`, not `test-genesis`
- Directory paths ‚Üí Use relative or PROJECT_ROOT, not GENESIS_ROOT
- Config files ‚Üí Should work for any project type
- CI/CD workflows ‚Üí Generic job names and steps

### The Litmus Test
Before creating any file, ask:
- "Would this work for a Python API project?"
- "Would this work for a CLI tool project?"
- "Would this work for a TypeScript library?"

If no, make it more generic.

## üö´ FORBIDDEN COMMIT SIGNATURES

**NEVER include any variation of these signatures in commits, PRs, or code:**

```
Generated with [Claude Code](https://claude.ai/code)
Generated with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>
Generated by Claude
Created with Claude Code
Claude AI assistance
AI-generated code
claude.ai/code
anthropic.com
noreply@anthropic.com
```

**Note**: Visual elements (emojis, icons) may change, but any reference to Claude, Anthropic, or AI assistance is forbidden.

**Reason**: Genesis is a professional development toolkit. All code should appear as human-authored work without AI attribution signatures.

## üö´ FORBIDDEN HARDCODED VALUES

**NEVER include hardcoded values or dangerous defaults in code:**

### Hardcoded Configuration Values
```python
# ‚ùå FORBIDDEN
DATABASE_URL = "postgresql://localhost:5432/app"
API_KEY = "sk-1234567890abcdef"
SERVICE_PORT = 8080

# ‚úÖ REQUIRED
DATABASE_URL = get_required_env("DATABASE_URL")
API_KEY = get_required_env("API_KEY")
SERVICE_PORT = int(get_required_env("SERVICE_PORT"))
```

### Dangerous Function Defaults
```python
# ‚ùå FORBIDDEN
def connect_db(host="localhost", port=5432, db="production"):
    pass

def send_request(url="https://api.hardcoded.com", timeout=30):
    pass

# ‚úÖ REQUIRED
def connect_db(host: str, port: int, db: str):
    """All parameters must be explicitly provided"""
    pass

def send_request(url: str, timeout: Optional[int] = None):
    """Use None/Optional for truly optional parameters"""
    pass
```

### Environment Variable Fallbacks
```python
# ‚ùå FORBIDDEN - Silent fallbacks hide configuration issues
database_url = os.environ.get("DATABASE_URL", "postgresql://localhost/app")
port = int(os.environ.get("PORT", "8080"))

# ‚úÖ REQUIRED - Fail fast with clear error messages
database_url = os.environ.get("DATABASE_URL")
if not database_url:
    raise ValueError("DATABASE_URL environment variable is required")
```

**Reason**: Hardcoded values create security risks, deployment issues, and make applications non-configurable. Genesis enforces fail-fast configuration loading and single source of truth patterns.

**Detection**: Use `scripts/find-hardcoded-values.sh` and `scripts/check-variable-defaults.sh` to systematically find violations.

## üö´ FORBIDDEN FILE CLUTTER

**NEVER place files in wrong locations - maintain clean project organization:**

### Root Directory Rules
Only these file types are allowed in project root:
- **Configuration**: `README.md`, `CLAUDE.md`, `Makefile`, `pyproject.toml`, `package.json`, `.gitignore`, `.envrc`
- **Licensing**: `LICENSE`, `SECURITY.md` 
- **Infrastructure**: `Dockerfile`, `docker-compose.yml`, `main.tf`, `variables.tf`

### Mandatory Directory Structure
```
project/
‚îú‚îÄ‚îÄ src/              # Source code ONLY
‚îú‚îÄ‚îÄ scripts/          # Executable utilities (.sh files)
‚îú‚îÄ‚îÄ tests/            # Test files (test_*.py, *.test.ts, conftest.py)
‚îú‚îÄ‚îÄ docs/             # Documentation (.md files except README/CLAUDE)
‚îî‚îÄ‚îÄ config/           # Configuration files (.json, .yml, .toml)
```

### File Placement Rules
```python
# ‚ùå FORBIDDEN - Clutters root directory
./my-script.sh           # ‚Üí Should be in scripts/
./api-docs.md           # ‚Üí Should be in docs/
./conftest.py          # ‚Üí Should be in tests/
./config.json          # ‚Üí Should be in config/
./util.py              # ‚Üí Should be in src/

# ‚úÖ REQUIRED - Proper organization
./scripts/my-script.sh
./docs/api-docs.md
./tests/conftest.py
./config/config.json
./src/util.py
```

**Reason**: File clutter makes projects hard to navigate, reduces professionalism, and violates standard project structure conventions.

**Detection**: Use `scripts/check-file-organization.sh` to systematically find misplaced files.

## ‚ö†Ô∏è Common Confusion Points

### Smart Commit
- **NOW**: We're extracting and simplifying smart-commit.sh from old code
- **FUTURE**: Projects will use the smart-commit tool we create

### Directory Structure
- **NOW**: Creating genesis-cli/, shared-python/, etc. directories
- **FUTURE**: Projects import FROM these directories via Genesis

### Sparse Worktrees
- **NOW**: Setting up Genesis to be sparse-worktree friendly
- **FUTURE**: Projects use Genesis tools to create sparse worktrees

### Bootstrap Process
- **NOW**: Creating the bootstrap.sh script and templates
- **FUTURE**: Running `genesis bootstrap` to create new projects

## Standard Project Structure

Genesis enforces a consistent folder structure across all projects:

```
project/
‚îú‚îÄ‚îÄ src/              # Source code
‚îú‚îÄ‚îÄ tests/            # Test files
‚îú‚îÄ‚îÄ docs/             # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ api/          # API documentation and references
‚îÇ   ‚îú‚îÄ‚îÄ guides/       # How-to guides and tutorials
‚îÇ   ‚îî‚îÄ‚îÄ architecture/ # System design and architecture decisions
‚îú‚îÄ‚îÄ scripts/          # Utility scripts (executable, self-documenting)
‚îú‚îÄ‚îÄ scratch/          # Temporary files (git-ignored)
‚îú‚îÄ‚îÄ .gitignore        # Includes scratch/ by default
‚îú‚îÄ‚îÄ Makefile          # Standard automation targets
‚îî‚îÄ‚îÄ README.md         # Project overview
```

### Folder Guidelines
- **scratch/**: Temporary workspace, always git-ignored
- **scripts/**: Executable utilities with `--help`, named `action-target.sh`
- **docs/**: Organized by type (api, guides, architecture)

## Current Genesis Components (Being Built)

### Phase 0: Foundation
- `CLAUDE.md` ‚Üê You are here
- `.envrc` and environment management
- Comprehensive ignore files
- Dependency management (Poetry, npm)
- Root Makefile for automation
- Standard project structure (docs/, scripts/, scratch/)

### Phase 1: Structure
- Component-based directories
- CI/CD with GitHub Actions
- Testing infrastructure

### Phase 2: Components
- **smart-commit/**: Quality gates before commits
- **worktree-tools/**: AI-safe sparse worktree creation
- **shared-python/**: Common utilities (retry, logger, config, health)
- **bootstrap/**: Project initialization system
- **genesis-cli/**: Main CLI with 4 commands
- **templates/**: Project templates (Python API, CLI, library)
- **shared-typescript/**: TypeScript versions of utilities

## AI Safety Rules (Apply to Both Modes)

### File Count Limits
- **Building Genesis**: Keep total project <5,000 lines
- **Using Genesis**: Each worktree <30 files for AI safety

### Sparse Worktree Isolation
- **Building Genesis**: Each component <30 files when checked out
- **Using Genesis**: Genesis enforces these limits automatically

### Quality Gates
- **Building Genesis**: We implement pre-commit hooks and testing
- **Using Genesis**: Genesis provides pre-configured quality gates

## What Genesis Will Provide (End Goal)

### CLI Commands
```bash
genesis bootstrap <name>    # Create new project with templates
genesis worktree create     # Create AI-safe sparse worktree
genesis sync               # Update shared components
genesis status             # Check project health
```

### Shared Libraries
- **Python**: `from shared_core import retry, logger, config, health`
- **TypeScript**: `import { retry, logger, config, health } from '@genesis/shared'`

### Templates & Patterns
- Pre-configured project templates
- Automatic worktree setup
- Built-in quality gates
- Security scanning
- AI safety enforcement

## Anti-Confusion Checklist

Before taking any action, verify:

- [ ] Am I building Genesis or using Genesis?
- [ ] Do I see `EXTRACTION_PLAN.md`? (Building mode)
- [ ] Am I creating components or using them?
- [ ] Are file paths in `/genesis/` (building) or `/project/` (using)?

## Success Metrics

### Building Genesis Success:
- [ ] Total lines reduced from 250,000+ to <5,000
- [ ] Each component <30 files for AI safety
- [ ] All manual setup steps automated
- [ ] Genesis can bootstrap itself

### Using Genesis Success:
- [ ] New project created in <2 minutes
- [ ] Automatic worktree isolation working
- [ ] Quality gates enforced by default
- [ ] Zero manual configuration needed

---

**Remember**: We are currently in **BUILDING** mode. Genesis doesn't exist yet - we're creating it.

Once Genesis is complete, this file will help AI assistants understand when they're working WITH Genesis vs ON Genesis.
