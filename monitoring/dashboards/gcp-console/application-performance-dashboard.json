{
  "displayName": "Universal Platform - Application Performance",
  "mosaicLayout": {
    "tiles": [
      {
        "width": 6,
        "height": 4,
        "widget": {
          "title": "HTTP Request Rate",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "sum by (service_name) (rate(http_requests_total{environment=~\"${environment}\"}[5m]))",
                  "unitOverride": "1/s"
                },
                "plotType": "LINE",
                "legendTemplate": "${service_name}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Requests/sec",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            }
          }
        }
      },
      {
        "xPos": 6,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "HTTP Error Rate",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "100 * sum by (service_name) (rate(http_requests_total{code=~\"5..\",environment=~\"${environment}\"}[5m])) / sum by (service_name) (rate(http_requests_total{environment=~\"${environment}\"}[5m]))",
                  "unitOverride": "%"
                },
                "plotType": "LINE",
                "legendTemplate": "${service_name}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Error Rate %",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            },
            "thresholds": [
              {
                "value": 1.0,
                "color": "YELLOW",
                "direction": "ABOVE"
              },
              {
                "value": 5.0,
                "color": "RED",
                "direction": "ABOVE"
              }
            ]
          }
        }
      },
      {
        "yPos": 4,
        "width": 12,
        "height": 4,
        "widget": {
          "title": "HTTP Response Time (P95)",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "histogram_quantile(0.95, sum by (service_name, le) (rate(http_request_duration_seconds_bucket{environment=~\"${environment}\"}[5m]))) * 1000",
                  "unitOverride": "ms"
                },
                "plotType": "LINE",
                "legendTemplate": "${service_name}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Response Time (ms)",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            },
            "thresholds": [
              {
                "value": 500.0,
                "color": "YELLOW",
                "direction": "ABOVE"
              },
              {
                "value": 1000.0,
                "color": "RED",
                "direction": "ABOVE"
              }
            ]
          }
        }
      },
      {
        "yPos": 8,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Database Query Performance",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "histogram_quantile(0.95, sum by (service_name, le) (rate(db_query_duration_seconds_bucket{environment=~\"${environment}\"}[5m]))) * 1000",
                  "unitOverride": "ms"
                },
                "plotType": "LINE",
                "legendTemplate": "${service_name} DB P95",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Query Time (ms)",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            }
          }
        }
      },
      {
        "xPos": 6,
        "yPos": 8,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Background Job Status",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "sum by (service_name, status) (rate(background_jobs_total{environment=~\"${environment}\"}[5m]))",
                  "unitOverride": "1/s"
                },
                "plotType": "STACKED_AREA",
                "legendTemplate": "${service_name} - ${status}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Jobs/sec",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            }
          }
        }
      },
      {
        "yPos": 12,
        "width": 12,
        "height": 4,
        "widget": {
          "title": "Cache Performance",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "100 * sum by (service_name) (rate(cache_operations_total{operation=\"hit\",environment=~\"${environment}\"}[5m])) / sum by (service_name) (rate(cache_operations_total{environment=~\"${environment}\"}[5m]))",
                  "unitOverride": "%"
                },
                "plotType": "LINE",
                "legendTemplate": "${service_name} Hit Rate",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Cache Hit Rate %",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            },
            "thresholds": [
              {
                "value": 80.0,
                "color": "YELLOW",
                "direction": "BELOW"
              },
              {
                "value": 50.0,
                "color": "RED",
                "direction": "BELOW"
              }
            ]
          }
        }
      },
      {
        "yPos": 16,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "CPU Usage",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\",environment=~\"${environment}\"}[5m])) * 100)",
                  "unitOverride": "%"
                },
                "plotType": "LINE",
                "legendTemplate": "${instance}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "CPU Usage %",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            },
            "thresholds": [
              {
                "value": 80.0,
                "color": "YELLOW",
                "direction": "ABOVE"
              },
              {
                "value": 95.0,
                "color": "RED",
                "direction": "ABOVE"
              }
            ]
          }
        }
      },
      {
        "xPos": 6,
        "yPos": 16,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Memory Usage",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "100 * (1 - node_memory_MemAvailable_bytes{environment=~\"${environment}\"} / node_memory_MemTotal_bytes{environment=~\"${environment}\"})",
                  "unitOverride": "%"
                },
                "plotType": "LINE",
                "legendTemplate": "${instance}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Memory Usage %",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            },
            "thresholds": [
              {
                "value": 80.0,
                "color": "YELLOW",
                "direction": "ABOVE"
              },
              {
                "value": 95.0,
                "color": "RED",
                "direction": "ABOVE"
              }
            ]
          }
        }
      },
      {
        "yPos": 20,
        "width": 12,
        "height": 4,
        "widget": {
          "title": "External API Dependencies",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "prometheusQuery": "100 - (100 * sum by (service_name, external_service) (rate(external_api_requests_total{code=~\"5..|4..\",environment=~\"${environment}\"}[5m])) / sum by (service_name, external_service) (rate(external_api_requests_total{environment=~\"${environment}\"}[5m])))",
                  "unitOverride": "%"
                },
                "plotType": "LINE",
                "legendTemplate": "${service_name} -> ${external_service}",
                "targetAxis": "Y1"
              }
            ],
            "timeshiftDuration": "0s",
            "yAxis": {
              "label": "Success Rate %",
              "scale": "LINEAR"
            },
            "chartOptions": {
              "mode": "COLOR"
            },
            "thresholds": [
              {
                "value": 99.0,
                "color": "YELLOW",
                "direction": "BELOW"
              },
              {
                "value": 95.0,
                "color": "RED",
                "direction": "BELOW"
              }
            ]
          }
        }
      },
      {
        "yPos": 24,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Business Metrics - User Registrations",
          "scorecard": {
            "timeSeriesQuery": {
              "prometheusQuery": "sum(increase(user_registrations_total{environment=~\"${environment}\"}[1h]))",
              "unitOverride": "1"
            },
            "gaugeView": {
              "lowerBound": 0.0,
              "upperBound": 1000.0
            },
            "sparkChartView": {
              "sparkChartType": "SPARK_LINE"
            }
          }
        }
      },
      {
        "xPos": 6,
        "yPos": 24,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "SLO Compliance",
          "scorecard": {
            "timeSeriesQuery": {
              "prometheusQuery": "avg(slo_compliance_ratio{environment=~\"${environment}\"}) * 100",
              "unitOverride": "%"
            },
            "gaugeView": {
              "lowerBound": 95.0,
              "upperBound": 100.0
            },
            "sparkChartView": {
              "sparkChartType": "SPARK_LINE"
            },
            "thresholds": [
              {
                "value": 99.0,
                "color": "YELLOW",
                "direction": "BELOW"
              },
              {
                "value": 95.0,
                "color": "RED",
                "direction": "BELOW"
              }
            ]
          }
        }
      }
    ]
  },
  "dashboardFilters": [
    {
      "filterType": "RESOURCE_LABEL",
      "labelKey": "environment",
      "stringValue": "production",
      "templateVariable": "environment"
    }
  ],
  "labels": {
    "universal-platform": "",
    "monitoring": "",
    "application-performance": ""
  }
}
