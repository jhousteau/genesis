# Universal Project Platform - Tagging Standards
# Comprehensive resource tagging strategy for compliance, cost management, and operations

tagging_standards:
  version: "1.0.0"
  organization: "whitehorse"
  
  # Global tagging requirements
  global:
    enforcement_level: "strict"  # strict, moderate, advisory
    case_sensitivity: false
    value_validation: true
    inheritance: true  # Child resources inherit parent tags
    
  # Required tags (must be present on all resources)
  required_tags:
    - name: "Environment"
      description: "Deployment environment"
      allowed_values: ["dev", "test", "staging", "prod"]
      validation_pattern: "^(dev|test|staging|prod)$"
      mandatory: true
      
    - name: "Project"
      description: "Project name or identifier"
      validation_pattern: "^[a-z][a-z0-9-]*[a-z0-9]$"
      max_length: 50
      mandatory: true
      
    - name: "Owner"
      description: "Resource owner or responsible team"
      validation_pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
      mandatory: true
      
    - name: "CostCenter"
      description: "Cost allocation identifier"
      validation_pattern: "^CC-[0-9]{4}$"
      mandatory: true
      examples: ["CC-1001", "CC-2003"]
      
  # Optional but recommended tags
  recommended_tags:
    - name: "Application"
      description: "Application or service name"
      validation_pattern: "^[a-zA-Z][a-zA-Z0-9-]*$"
      
    - name: "Version"
      description: "Application or infrastructure version"
      validation_pattern: "^v?[0-9]+\\.[0-9]+\\.[0-9]+$"
      examples: ["v1.2.3", "2.1.0"]
      
    - name: "Team"
      description: "Owning team name"
      allowed_values: ["platform", "frontend", "backend", "data", "security", "devops"]
      
    - name: "Component"
      description: "System component type"
      allowed_values: ["frontend", "backend", "database", "cache", "queue", "storage", "network"]
      
    - name: "Criticality"
      description: "Business criticality level"
      allowed_values: ["critical", "high", "medium", "low"]
      default: "medium"
      
    - name: "DataClassification"
      description: "Data sensitivity classification"
      allowed_values: ["public", "internal", "confidential", "restricted"]
      default: "internal"
      
    - name: "BackupRequired"
      description: "Whether resource requires backup"
      allowed_values: ["true", "false"]
      data_type: "boolean"
      default: "true"
      
    - name: "MonitoringEnabled"
      description: "Whether monitoring is enabled"
      allowed_values: ["true", "false"]
      data_type: "boolean"
      default: "true"
      
    - name: "AutoShutdown"
      description: "Automatic shutdown schedule"
      validation_pattern: "^(never|daily|weekends|custom)$"
      default: "never"
      
  # Operational tags
  operational_tags:
    - name: "CreatedBy"
      description: "User or system that created the resource"
      auto_populated: true
      immutable: true
      
    - name: "CreatedDate"
      description: "Resource creation timestamp"
      format: "ISO8601"
      auto_populated: true
      immutable: true
      
    - name: "LastModified"
      description: "Last modification timestamp"
      format: "ISO8601"
      auto_populated: true
      
    - name: "LastModifiedBy"
      description: "User who last modified the resource"
      auto_populated: true
      
    - name: "ManagedBy"
      description: "Management system or tool"
      allowed_values: ["terraform", "ansible", "manual", "cloudformation", "arm-template"]
      default: "terraform"
      
  # Cost management tags
  cost_tags:
    - name: "BillingCode"
      description: "Billing identifier for chargeback"
      validation_pattern: "^BC-[A-Z0-9]{6}$"
      examples: ["BC-ABC123", "BC-XYZ789"]
      
    - name: "BudgetCategory"
      description: "Budget allocation category"
      allowed_values: ["infrastructure", "development", "testing", "operations", "research"]
      
    - name: "CostOptimization"
      description: "Cost optimization status"
      allowed_values: ["optimized", "review-needed", "high-cost", "acceptable"]
      default: "acceptable"
      
  # Compliance tags
  compliance_tags:
    - name: "ComplianceFramework"
      description: "Applicable compliance frameworks"
      allowed_values: ["soc2", "hipaa", "gdpr", "pci-dss", "iso27001", "none"]
      multi_value: true
      
    - name: "DataRetention"
      description: "Data retention period in days"
      validation_pattern: "^[0-9]+d$"
      examples: ["30d", "365d", "2555d"]
      
    - name: "EncryptionRequired"
      description: "Encryption requirement"
      allowed_values: ["true", "false"]
      data_type: "boolean"
      default: "true"
      
    - name: "AuditLogging"
      description: "Audit logging requirement"
      allowed_values: ["enabled", "disabled", "required"]
      default: "enabled"
      
  # Environment-specific tag requirements
  environment_specific:
    prod:
      additional_required:
        - "ChangeManagementTicket"
        - "BusinessOwner"
        - "TechnicalOwner"
        - "SupportContact"
      additional_validation:
        - tag: "ChangeManagementTicket"
          pattern: "^CHG-[0-9]{8}$"
        - tag: "BusinessOwner"
          pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
          
    staging:
      additional_required:
        - "TestPlan"
        - "TestOwner"
        
    dev:
      relaxed_validation: true
      optional_override: true
      
  # Resource-specific tagging rules
  resource_specific:
    compute:
      gcp_compute_engine:
        additional_tags:
          - "InstanceType"
          - "OperatingSystem" 
          - "PatchGroup"
          
      aws_ec2:
        additional_tags:
          - "InstanceType"
          - "AMI"
          - "SecurityGroup"
          
      azure_vm:
        additional_tags:
          - "VMSize"
          - "OSType"
          - "AvailabilitySet"
          
    storage:
      additional_tags:
        - "StorageType"
        - "AccessTier"
        - "LifecyclePolicy"
        
    database:
      additional_tags:
        - "Engine"
        - "EngineVersion" 
        - "BackupRetention"
        - "MaintenanceWindow"
        
    networking:
      additional_tags:
        - "NetworkType"
        - "SecurityLevel"
        - "ConnectivityType"
        
  # Auto-tagging rules
  auto_tagging:
    enabled: true
    rules:
      - trigger: "resource_creation"
        tags:
          CreatedDate: "{{ current_timestamp }}"
          CreatedBy: "{{ current_user }}"
          ManagedBy: "{{ deployment_tool }}"
          
      - trigger: "resource_modification"
        tags:
          LastModified: "{{ current_timestamp }}"
          LastModifiedBy: "{{ current_user }}"
          
      - trigger: "cost_threshold"
        condition: "monthly_cost > 1000"
        tags:
          CostAlert: "high-cost-resource"
          ReviewRequired: "true"
          
  # Tag inheritance rules
  inheritance:
    enabled: true
    hierarchy:
      - organization
      - folder
      - project
      - resource_group
      - resource
      
    inherited_tags:
      - "Organization"
      - "CostCenter" 
      - "ComplianceFramework"
      - "DataClassification"
      
  # Validation rules
  validation:
    global_rules:
      - rule: "required_tags_present"
        description: "All required tags must be present"
        severity: "error"
        
      - rule: "tag_value_format"
        description: "Tag values must match defined patterns"
        severity: "error"
        
      - rule: "tag_value_length"
        description: "Tag values must not exceed maximum length"
        max_length: 256
        severity: "warning"
        
      - rule: "reserved_tag_names"
        description: "Reserved tag names cannot be used"
        reserved_names: ["aws:", "azure:", "gcp:", "kubernetes.io/", "k8s.io/"]
        severity: "error"
        
    environment_rules:
      prod:
        - rule: "no_test_values"
          description: "Production resources cannot have test-related tag values"
          forbidden_patterns: ["test", "temp", "temporary", "delete-me"]
          severity: "error"
          
  # Reporting and analytics
  reporting:
    cost_allocation:
      primary_dimensions:
        - "Project"
        - "Environment" 
        - "CostCenter"
        - "Team"
        
      secondary_dimensions:
        - "Application"
        - "Component"
        - "BudgetCategory"
        
    compliance_tracking:
      required_for_audit:
        - "ComplianceFramework"
        - "DataClassification"
        - "EncryptionRequired"
        - "AuditLogging"
        - "DataRetention"
        
    operational_insights:
      utilization_analysis:
        - "Criticality"
        - "AutoShutdown"
        - "BackupRequired"
        - "MonitoringEnabled"
        
# Tag templates for common scenarios
templates:
  web_application:
    required:
      Environment: "{{ environment }}"
      Project: "{{ project_name }}"
      Owner: "{{ owner_email }}"
      CostCenter: "{{ cost_center }}"
    recommended:
      Application: "{{ app_name }}"
      Component: "frontend"
      Team: "frontend"
      Criticality: "high"
      
  database:
    required:
      Environment: "{{ environment }}"
      Project: "{{ project_name }}" 
      Owner: "{{ owner_email }}"
      CostCenter: "{{ cost_center }}"
    recommended:
      Component: "database"
      Team: "backend"
      Criticality: "critical"
      BackupRequired: "true"
      EncryptionRequired: "true"
      
  development_resource:
    required:
      Environment: "dev"
      Project: "{{ project_name }}"
      Owner: "{{ developer_email }}"
      CostCenter: "{{ dev_cost_center }}"
    recommended:
      AutoShutdown: "daily"
      Criticality: "low"
      BackupRequired: "false"