---
# Security Policy for Universal Platform
version: 2.0.0
last_updated: 2024-01-01

security_requirements:
  authentication:
    required: true
    methods:
      - oauth2
      - api_key
      - service_account
    multi_factor: 
      enabled: true
      required_for: ["production", "staging"]
  
  authorization:
    model: RBAC
    principle: least_privilege
    review_frequency: quarterly
  
  encryption:
    data_at_rest:
      required: true
      algorithm: AES-256-GCM
      key_rotation: 90d
    
    data_in_transit:
      required: true
      minimum_tls: "1.2"
      preferred_tls: "1.3"
      cipher_suites:
        - TLS_AES_256_GCM_SHA384
        - TLS_AES_128_GCM_SHA256
        - TLS_CHACHA20_POLY1305_SHA256
  
  secrets_management:
    storage: 
      - google_secret_manager
      - hashicorp_vault
    rotation:
      api_keys: 90d
      passwords: 60d
      certificates: 365d
    forbidden_locations:
      - source_code
      - configuration_files
      - logs
      - environment_variables_in_containers

vulnerability_management:
  scanning:
    frequency: daily
    tools:
      - snyk
      - trivy
      - sonarqube
    severity_thresholds:
      critical: immediate
      high: 24h
      medium: 7d
      low: 30d
  
  dependency_updates:
    security_patches: immediate
    minor_updates: weekly
    major_updates: monthly
    
  container_security:
    base_images:
      scan_on_build: true
      approved_registries:
        - gcr.io
        - docker.io
    runtime_security:
      - no_root_users
      - read_only_filesystem
      - no_privileged_containers

access_control:
  service_accounts:
    naming_convention: "{{project}}-{{environment}}-{{service}}-sa"
    key_rotation: 90d
    audit_logging: required
  
  api_access:
    rate_limiting: true
    authentication: required
    audit_logging: required
    
  database_access:
    direct_access: forbidden
    access_method: application_only
    connection_encryption: required

compliance:
  standards:
    - SOC2
    - GDPR
    - HIPAA
    - PCI-DSS
  
  audit_requirements:
    retention: 7_years
    immutability: true
    encryption: required
    
  data_protection:
    classification:
      - public
      - internal
      - confidential
      - restricted
    handling:
      pii_detection: automated
      pii_masking: required
      data_retention: policy_based

incident_response:
  detection:
    monitoring: 24x7
    alerting: automated
    escalation: tiered
    
  response_times:
    critical: 15_minutes
    high: 1_hour
    medium: 4_hours
    low: 24_hours
    
  post_incident:
    review: required
    documentation: required
    lessons_learned: required

security_testing:
  static_analysis:
    frequency: on_commit
    tools:
      - semgrep
      - bandit
      - gosec
  
  dynamic_analysis:
    frequency: weekly
    tools:
      - owasp_zap
      - burp_suite
  
  penetration_testing:
    frequency: annually
    scope: full_application
    provider: third_party